{{ define "main" }}
{{/* Resource Single Page Template - Individual resource detail page with full SEO */}}

<div class="min-h-screen bg-gradient-to-br from-overcast-50 via-white to-sound-50/30 dark:from-overcast-900 dark:via-overcast-900 dark:to-overcast-950">
  <!-- Breadcrumb Navigation -->
  <nav class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-4" aria-label="Breadcrumb">
    <ol class="flex items-center space-x-2 text-sm text-overcast-500" itemscope itemtype="https://schema.org/BreadcrumbList">
      <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a href="/" itemprop="item" class="hover:text-sound-600 transition-colors">
          <span itemprop="name">Home</span>
        </a>
        <meta itemprop="position" content="1">
      </li>
      <li class="flex items-center">
        <svg class="w-4 h-4 mx-1" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
        </svg>
      </li>
      <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a href="/resources/" itemprop="item" class="hover:text-sound-600 transition-colors">
          <span itemprop="name">Resources</span>
        </a>
        <meta itemprop="position" content="2">
      </li>
      <li class="flex items-center">
        <svg class="w-4 h-4 mx-1" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
        </svg>
      </li>
      <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem" class="text-overcast-900 dark:text-white font-medium">
        <span itemprop="name">{{ .Title }}</span>
        <meta itemprop="position" content="3">
      </li>
    </ol>
  </nav>

  <!-- Main Content -->
  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pb-16">
    <article itemscope itemtype="https://schema.org/Service" class="card-bouncy p-8 lg:p-10">
      <!-- Resource Header -->
      <header class="mb-8">
        <!-- Categories & Location Badges -->
        <div class="flex flex-wrap items-center gap-2 mb-4">
          {{ with .Params.categories }}
            {{ range . }}
            <span class="badge-fun bg-sound-100 text-sound-700 dark:bg-sound-900 dark:text-sound-300 text-xs">
              {{ . | title }}
            </span>
            {{ end }}
          {{ end }}
          {{ with .Params.city }}
            {{ if ne . "Online" }}
            <span class="badge-fun bg-fir-100 text-fir-700 dark:bg-fir-900 dark:text-fir-300 text-xs flex items-center">
              <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
              </svg>
              {{ . }}
            </span>
            {{ else }}
            <span class="badge-fun bg-overcast-100 text-overcast-600 dark:bg-overcast-800 dark:text-overcast-400 text-xs flex items-center">
              <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
              </svg>
              Online
            </span>
            {{ end }}
          {{ end }}
          {{ if .Params.featured }}
          <span class="badge-fun bg-roast-light/20 text-roast-dark dark:bg-roast-espresso dark:text-roast-light text-xs flex items-center">
            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            Featured
          </span>
          {{ end }}
        </div>

        <!-- Title -->
        <h1 class="font-display font-bold text-3xl lg:text-4xl text-overcast-900 dark:text-white mb-3" itemprop="name">
          {{ .Title }}
        </h1>

        <!-- Organization -->
        {{ with .Params.organization }}
        <p class="text-lg text-overcast-500 dark:text-overcast-400 flex items-center" itemprop="provider" itemscope itemtype="https://schema.org/Organization">
          <svg class="w-5 h-5 mr-2 opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
          </svg>
          <span itemprop="name">{{ . }}</span>
        </p>
        {{ end }}

        <!-- Cost Badge -->
        {{ with .Params.cost }}
        <div class="mt-4">
          <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold {{ if eq . "Free" }}bg-fir-100 text-fir-700 dark:bg-fir-900 dark:text-fir-300{{ else }}bg-overcast-100 text-overcast-700 dark:bg-overcast-800 dark:text-overcast-300{{ end }}" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
            <meta itemprop="price" content="{{ if eq . "Free" }}0{{ else }}{{ . }}{{ end }}">
            <meta itemprop="priceCurrency" content="USD">
            {{ if eq . "Free" }}
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            {{ end }}
            {{ . }}
          </span>
        </div>
        {{ end }}
      </header>

      <!-- Description -->
      <section class="mb-10">
        <div class="prose prose-lg max-w-none" itemprop="description">
          <p class="text-overcast-600 dark:text-overcast-300 leading-relaxed text-lg">
            {{ .Params.description }}
          </p>
        </div>
        {{ with .Content }}
        <div class="mt-6 prose prose-lg max-w-none text-overcast-600 dark:text-overcast-300">
          {{ . }}
        </div>
        {{ end }}
      </section>

      <!-- Details Grid -->
      <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
        <!-- Eligibility -->
        {{ with .Params.eligibility }}
        <div class="bg-overcast-50 dark:bg-overcast-800 rounded-xl p-5">
          <h2 class="font-display font-semibold text-overcast-900 dark:text-white text-sm uppercase tracking-wider mb-3 flex items-center">
            <svg class="w-4 h-4 mr-2 text-sound-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            Who Can Apply
          </h2>
          <p class="text-overcast-600 dark:text-overcast-300" itemprop="eligibleRegion">{{ . }}</p>
        </div>
        {{ end }}

        <!-- Counties Served -->
        {{ with .Params.counties }}
        <div class="bg-overcast-50 dark:bg-overcast-800 rounded-xl p-5">
          <h2 class="font-display font-semibold text-overcast-900 dark:text-white text-sm uppercase tracking-wider mb-3 flex items-center">
            <svg class="w-4 h-4 mr-2 text-fir-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
            </svg>
            Areas Served
          </h2>
          <div class="flex flex-wrap gap-2" itemprop="areaServed">
            {{ range . }}
            <span class="inline-block px-3 py-1.5 bg-white dark:bg-overcast-700 rounded-lg text-sm text-overcast-600 dark:text-overcast-300 shadow-sm">
              {{ . }} County
            </span>
            {{ end }}
          </div>
        </div>
        {{ end }}
      </section>

      <!-- Audience Tags -->
      {{ with .Params.audiences }}
      {{ if gt (len .) 0 }}
      <section class="mb-10">
        <h2 class="font-display font-semibold text-overcast-900 dark:text-white text-sm uppercase tracking-wider mb-4 flex items-center">
          <svg class="w-4 h-4 mr-2 text-sound-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
          </svg>
          Designed For
        </h2>
        <div class="flex flex-wrap gap-2">
          {{ range . }}
          <span class="inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-sound-100 text-sound-700 dark:bg-sound-900 dark:text-sound-300">
            {{ if eq . "bipoc" }}BIPOC{{ else if eq . "lgbtq" }}LGBTQ+{{ else }}{{ . | humanize | title }}{{ end }} Founders
          </span>
          {{ end }}
        </div>
      </section>
      {{ end }}
      {{ end }}

      <!-- CTA Section -->
      <footer class="flex flex-col sm:flex-row gap-4 pt-8 border-t border-overcast-200 dark:border-overcast-700">
        <a href="{{ .Params.website }}"
           target="_blank"
           rel="noopener noreferrer"
           class="flex-1 inline-flex items-center justify-center px-8 py-4 sun-break text-white rounded-xl font-semibold shadow-lg shadow-sound-500/25 hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200"
           data-track-click
           data-resource-name="{{ .Title }}"
           data-resource-url="{{ .Params.website }}"
           itemprop="url">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
          </svg>
          Visit Website
        </a>
        <a href="/resources/"
           class="inline-flex items-center justify-center px-8 py-4 bg-overcast-100 hover:bg-overcast-200 dark:bg-overcast-800 dark:hover:bg-overcast-700 text-overcast-700 dark:text-overcast-300 rounded-xl font-medium transition-colors duration-200">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
          </svg>
          Browse All Resources
        </a>
      </footer>
    </article>

    <!-- Related Resources -->
    {{ $category := index (default (slice "resources") .Params.categories) 0 }}
    {{ $currentSlug := .File.BaseFileName }}
    {{ $related := slice }}
    {{ range $file := readDir "data/resources" }}
      {{ $data := index $.Site.Data.resources (replace $file.Name ".yaml" "") }}
      {{ with $data.resources }}
        {{ range . }}
          {{ $slug := .name | urlize }}
          {{ if and (ne $slug $currentSlug) (in .categories $category) }}
            {{ $related = $related | append . }}
          {{ end }}
        {{ end }}
      {{ end }}
    {{ end }}
    {{ if gt (len $related) 0 }}
    <section class="mt-12">
      <h2 class="font-display font-bold text-2xl text-overcast-900 dark:text-white mb-6">
        Related {{ $category | title }} Resources
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {{ range first 3 $related }}
        {{ partial "resource-card.html" . }}
        {{ end }}
      </div>
    </section>
    {{ end }}
  </main>
</div>

<!-- Structured Data for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Service",
  "name": {{ .Title | jsonify }},
  "description": {{ .Params.description | jsonify }},
  "provider": {
    "@type": "Organization",
    "name": {{ .Params.organization | default .Site.Title | jsonify }}
  },
  "areaServed": {
    "@type": "State",
    "name": "Washington",
    "containsPlace": [
      {{ range $i, $county := .Params.counties }}{{ if $i }},{{ end }}
      {
        "@type": "AdministrativeArea",
        "name": "{{ $county }} County, WA"
      }
      {{ end }}
    ]
  },
  "offers": {
    "@type": "Offer",
    "price": {{ if eq .Params.cost "Free" }}"0"{{ else }}{{ .Params.cost | jsonify }}{{ end }},
    "priceCurrency": "USD",
    "availability": "https://schema.org/InStock"
  },
  "url": {{ .Params.website | jsonify }},
  "category": {{ index (default (slice "Startup Resources") .Params.categories) 0 | jsonify }}
}
</script>
{{ end }}
