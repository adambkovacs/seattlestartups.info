{{ define "main" }}
<div class="relative">
  <!-- Hero Section -->
  <section class="relative overflow-hidden py-12 lg:py-20 border-b border-overcast-200 dark:border-overcast-700">
    <div class="absolute inset-0 dots-pattern opacity-30 dark:opacity-10"></div>

    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-4xl">
        <!-- Breadcrumb -->
        <nav class="flex mb-6" aria-label="Breadcrumb">
          <ol class="flex items-center space-x-2 text-sm font-mono">
            <li><a href="{{ .Site.BaseURL }}" class="text-overcast-500 dark:text-overcast-400 hover:text-sound-600 dark:hover:text-sound-400 transition-colors">Home</a></li>
            <li class="text-overcast-300 dark:text-overcast-600">/</li>
            <li class="text-sound-600 dark:text-sound-400 font-medium">{{ .Title }}</li>
          </ol>
        </nav>

        <h1 class="font-display font-black text-4xl md:text-5xl lg:text-6xl text-overcast-900 dark:text-white mb-4 tracking-tight">
          {{ .Title }}
        </h1>

        <p class="text-lg md:text-xl text-overcast-600 dark:text-overcast-300 leading-relaxed mb-8 max-w-2xl">
          {{ with .Description }}{{ . }}{{ else }}Practical, actionable guides for founders at every stage of the startup journey.{{ end }}
        </p>

        <!-- Stats -->
        <div class="flex flex-wrap items-center gap-6 text-sm font-mono text-overcast-500 dark:text-overcast-400">
          <div class="flex items-center gap-2">
            <span class="inline-block w-2 h-2 rounded-full bg-fir-500 animate-pulse"></span>
            <span class="font-bold text-overcast-900 dark:text-white">{{ len .Pages }}</span>
            <span>guides</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-overcast-300 dark:text-overcast-600">|</span>
            <span>Updated {{ now.Format "January 2006" }}</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Playful Filter Section -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="flex flex-wrap items-center gap-3">
      <span class="text-sm font-medium text-overcast-500 dark:text-overcast-400 mr-2">Filter by:</span>

      <!-- Filter Pills - Playful but elegant -->
      <button data-filter="all" class="guide-filter active inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-sound-100 dark:bg-sound-900/50 text-sound-700 dark:text-sound-300 hover:scale-105 hover:shadow-md border-2 border-transparent hover:border-sound-300 dark:hover:border-sound-600">
        <span class="text-base">‚ú®</span> All Guides
      </button>

      <button data-filter="getting-started" class="guide-filter inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300 hover:scale-105 hover:shadow-md border-2 border-transparent hover:border-emerald-300 dark:hover:border-emerald-600">
        <span class="text-base">üöÄ</span> Getting Started
      </button>

      <button data-filter="funding" class="guide-filter inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-amber-50 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 hover:scale-105 hover:shadow-md border-2 border-transparent hover:border-amber-300 dark:hover:border-amber-600">
        <span class="text-base">üí∞</span> Funding
      </button>

      <button data-filter="accelerators" class="guide-filter inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-violet-50 dark:bg-violet-900/30 text-violet-700 dark:text-violet-300 hover:scale-105 hover:shadow-md border-2 border-transparent hover:border-violet-300 dark:hover:border-violet-600">
        <span class="text-base">‚ö°</span> Accelerators
      </button>

      <button data-filter="location" class="guide-filter inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-sky-50 dark:bg-sky-900/30 text-sky-700 dark:text-sky-300 hover:scale-105 hover:shadow-md border-2 border-transparent hover:border-sky-300 dark:hover:border-sky-600">
        <span class="text-base">üìç</span> By Location
      </button>

      <button data-filter="founders" class="guide-filter inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-rose-50 dark:bg-rose-900/30 text-rose-700 dark:text-rose-300 hover:scale-105 hover:shadow-md border-2 border-transparent hover:border-rose-300 dark:hover:border-rose-600">
        <span class="text-base">üë•</span> For Founders
      </button>

      <button data-filter="industry" class="guide-filter inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-teal-50 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300 hover:scale-105 hover:shadow-md border-2 border-transparent hover:border-teal-300 dark:hover:border-teal-600">
        <span class="text-base">üè≠</span> Industry
      </button>
    </div>
  </section>

  <!-- Guides Grid -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
    {{ if .Pages }}
    <div id="guides-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {{ range .Pages.ByDate.Reverse }}
      {{/* Determine filter categories based on tags/title */}}
      {{ $categories := slice "all" }}
      {{ $title := .Title | lower }}
      {{ $tags := .Params.tags | default slice }}

      {{/* Getting Started */}}
      {{ if or (in $title "first") (in $title "getting started") (in $title "top 3") (in $title "checklist") }}
        {{ $categories = $categories | append "getting-started" }}
      {{ end }}

      {{/* Funding */}}
      {{ if or (in $title "funding") (in $title "fund") (in $tags "funding") }}
        {{ $categories = $categories | append "funding" }}
      {{ end }}

      {{/* Accelerators */}}
      {{ if or (in $title "accelerator") (in $title "incubator") (in $tags "accelerators") }}
        {{ $categories = $categories | append "accelerators" }}
      {{ end }}

      {{/* Location-based */}}
      {{ if or (in $title "king county") (in $title "pierce county") (in $title "snohomish") (in $title "regional") (in $tags "king county") (in $tags "pierce county") }}
        {{ $categories = $categories | append "location" }}
      {{ end }}

      {{/* For Founders (identity-based) */}}
      {{ if or (in $title "women") (in $title "bipoc") (in $title "veteran") (in $tags "women founders") (in $tags "bipoc founders") (in $tags "veteran founders") }}
        {{ $categories = $categories | append "founders" }}
      {{ end }}

      {{/* Industry */}}
      {{ if or (in $title "climate") (in $title "ai") (in $title "tech") (in $tags "climate tech") (in $tags "ai") }}
        {{ $categories = $categories | append "industry" }}
      {{ end }}

      <article class="guide-card group bg-white dark:bg-overcast-800 rounded-2xl border border-overcast-200 dark:border-overcast-700 overflow-hidden transition-all duration-300 hover:border-sound-400 dark:hover:border-sound-500 hover:shadow-xl hover:shadow-sound-500/10 dark:hover:shadow-sound-500/20 hover:-translate-y-1"
               data-categories="{{ delimit $categories " " }}">
        <a href="{{ .Permalink }}" class="block p-6">
          <!-- Category Tag -->
          {{ with .Params.tags }}
          <div class="flex flex-wrap gap-2 mb-4">
            {{ range first 2 . }}
            <span class="inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-sound-50 dark:bg-sound-900/50 text-sound-700 dark:text-sound-300">
              {{ . | humanize }}
            </span>
            {{ end }}
          </div>
          {{ end }}

          <!-- Title -->
          <h2 class="font-display font-bold text-xl text-overcast-900 dark:text-white mb-3 group-hover:text-sound-600 dark:group-hover:text-sound-400 transition-colors line-clamp-2">
            {{ .Title }}
          </h2>

          <!-- Description -->
          <p class="text-overcast-600 dark:text-overcast-300 text-sm leading-relaxed mb-4 line-clamp-3">
            {{ .Description }}
          </p>

          <!-- Meta -->
          <div class="flex items-center justify-between text-xs text-overcast-500 dark:text-overcast-400">
            <span>{{ .Date.Format "Jan 2, 2006" }}</span>
            <span class="flex items-center gap-1 group-hover:text-sound-600 dark:group-hover:text-sound-400 transition-colors">
              Read guide
              <svg class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </span>
          </div>
        </a>
      </article>
      {{ end }}
    </div>

    <!-- No Results Message (hidden by default) -->
    <div id="no-results" class="hidden text-center py-20">
      <div class="w-20 h-20 mx-auto mb-6 rounded-2xl bg-overcast-100 dark:bg-overcast-800 flex items-center justify-center">
        <span class="text-4xl">üîç</span>
      </div>
      <h3 class="font-display font-bold text-xl text-overcast-700 dark:text-overcast-200 mb-2">No guides match this filter</h3>
      <p class="text-overcast-500 dark:text-overcast-400 mb-4">Try selecting a different category or browse all guides.</p>
      <button id="show-all-guides" class="text-sound-600 dark:text-sound-400 font-medium hover:underline">
        Show all guides ‚Üí
      </button>
    </div>
    {{ else }}
    <!-- Empty State -->
    <div class="text-center py-20">
      <div class="w-20 h-20 mx-auto mb-6 rounded-2xl bg-overcast-100 dark:bg-overcast-800 flex items-center justify-center">
        <svg class="w-10 h-10 text-overcast-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
        </svg>
      </div>
      <h3 class="font-display font-bold text-xl text-overcast-700 dark:text-overcast-200 mb-2">Guides coming soon</h3>
      <p class="text-overcast-500 dark:text-overcast-400">We're working on comprehensive guides for Seattle founders.</p>
    </div>
    {{ end }}
  </section>

  <!-- CTA Section -->
  <section class="border-t border-overcast-200 dark:border-overcast-700 bg-overcast-50 dark:bg-overcast-800/50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center">
      <h2 class="font-display font-bold text-2xl md:text-3xl text-overcast-900 dark:text-white mb-4">
        Looking for specific resources?
      </h2>
      <p class="text-lg text-overcast-600 dark:text-overcast-300 mb-8 max-w-xl mx-auto">
        Browse our directory of 248+ free startup resources across Greater Seattle.
      </p>
      <a href="/resources/" class="inline-flex items-center px-8 py-4 sun-break text-white rounded-xl font-semibold text-lg shadow-xl hover:shadow-2xl transform hover:-translate-y-1 transition-all duration-200">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
        </svg>
        Browse Resources
      </a>
    </div>
  </section>
</div>

<!-- Filter JavaScript -->
<script>
(function() {
  const filters = document.querySelectorAll('.guide-filter');
  const cards = document.querySelectorAll('.guide-card');
  const noResults = document.getElementById('no-results');

  filters.forEach(filter => {
    filter.addEventListener('click', function() {
      const category = this.dataset.filter;

      // Update active state
      filters.forEach(f => {
        f.classList.remove('active', 'ring-2', 'ring-offset-2', 'ring-sound-500', 'dark:ring-offset-overcast-900');
      });
      this.classList.add('active', 'ring-2', 'ring-offset-2', 'ring-sound-500', 'dark:ring-offset-overcast-900');

      // Filter cards
      let visibleCount = 0;
      cards.forEach(card => {
        const cardCategories = card.dataset.categories.split(' ');
        if (category === 'all' || cardCategories.includes(category)) {
          card.style.display = '';
          card.style.opacity = '1';
          card.style.transform = 'scale(1)';
          visibleCount++;
        } else {
          card.style.opacity = '0';
          card.style.transform = 'scale(0.95)';
          setTimeout(() => {
            if (!cardCategories.includes(document.querySelector('.guide-filter.active').dataset.filter) &&
                document.querySelector('.guide-filter.active').dataset.filter !== 'all') {
              card.style.display = 'none';
            }
          }, 200);
        }
      });

      // Show/hide no results message
      if (visibleCount === 0) {
        noResults.classList.remove('hidden');
      } else {
        noResults.classList.add('hidden');
      }
    });
  });

  // Show all guides button (CSP-compliant, no inline onclick)
  const showAllBtn = document.getElementById('show-all-guides');
  if (showAllBtn) {
    showAllBtn.addEventListener('click', function() {
      document.querySelector('[data-filter=all]').click();
    });
  }
})();
</script>
{{ end }}
