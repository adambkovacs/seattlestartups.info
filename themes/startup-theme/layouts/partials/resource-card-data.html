{{/* Resource Card Partial for YAML Data */}}
{{ $category := index .categories 0 | default "General" }}
{{ $county := index .counties 0 | default "" }}

<article class="card-bouncy group relative bg-white dark:bg-overcast-800 overflow-hidden"
         data-resource-card
         data-title="{{ .name }}"
         data-description="{{ .description }}"
         data-category="{{ $category | urlize }}">

  <!-- Gradient top border -->
  <div class="absolute top-0 left-0 right-0 h-1 sun-break transform origin-left scale-x-0 group-hover:scale-x-100 transition-transform duration-500"></div>

  <!-- Card Content -->
  <div class="p-6">
    <!-- Header with category icon -->
    <div class="flex items-start justify-between mb-4">
      <div class="flex-shrink-0 w-12 h-12 rounded-xl sun-break flex items-center justify-center shadow-lg shadow-sound-500/20 group-hover:scale-110 transition-transform duration-300">
        {{ partial "category-icon.html" $category }}
      </div>

      {{ with $county }}
      <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-fir-100 dark:bg-fir-900/50 text-fir-600 dark:text-fir-400">
        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
        </svg>
        {{ . }}
      </span>
      {{ end }}
    </div>

    <!-- Title - Links to internal resource page -->
    <h3 class="font-display font-semibold text-lg text-overcast-900 dark:text-white mb-2 group-hover:text-sound-600 dark:group-hover:text-sound-400 transition-colors duration-200 line-clamp-2">
      <a href="/resources/{{ .name | urlize }}/" class="after:absolute after:inset-0">
        {{ .name }}
      </a>
    </h3>

    <!-- Description -->
    <p class="text-overcast-600 dark:text-overcast-300 text-sm leading-relaxed mb-4 line-clamp-3">
      {{ .description }}
    </p>

    <!-- Meta info -->
    <div class="flex flex-wrap items-center gap-3 mb-4">
      {{ with .organization }}
      <span class="inline-flex items-center text-xs text-overcast-500 dark:text-overcast-400">
        <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
        </svg>
        {{ . | truncate 25 }}
      </span>
      {{ end }}

      {{ with .cost }}
      <span class="inline-flex items-center text-xs font-medium text-fir-600 dark:text-fir-400 bg-fir-50 dark:bg-fir-900/50 px-2 py-0.5 rounded-full">
        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
        {{ . }}
      </span>
      {{ end }}
    </div>

    <!-- Category badge and Visit link -->
    <div class="flex items-center justify-between">
      <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-overcast-100 dark:bg-overcast-700 text-overcast-600 dark:text-overcast-300">
        {{ $category }}
      </span>

      <!-- Visit external site link (prevents card click-through) -->
      <a href="{{ .website }}"
         target="_blank"
         rel="noopener noreferrer"
         class="relative z-10 inline-flex items-center text-xs font-medium text-sound-600 dark:text-sound-400 hover:text-sound-700 dark:hover:text-sound-300 transition-colors"
         onclick="event.stopPropagation();">
        Visit
        <svg class="w-3.5 h-3.5 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
        </svg>
      </a>
    </div>
  </div>

  <!-- Hover gradient overlay -->
  <div class="absolute inset-0 bg-gradient-to-t from-sound-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
</article>
